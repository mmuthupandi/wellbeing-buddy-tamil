export type Language = "english" | "tamil";

export type Intent = 
  | "greeting"
  | "anxiety" 
  | "stress"
  | "sleep"
  | "low_mood"
  | "coping"
  | "mood_tracking"
  | "gratitude"
  | "meta"
  | "crisis"
  | "general";

export interface ChatResponse {
  message: string;
  intent: Intent;
  isEmergency: boolean;
}

// Crisis detection keywords
const CRISIS_KEYWORDS = [
  // English
  "suicide", "kill myself", "end my life", "want to die", "harm myself", 
  "not worth living", "better off dead", "end it all", "take my own life",
  "hurt myself", "self harm", "cut myself", "overdose", "jump off",
  
  // Tamil (common crisis expressions)
  "родро▒рпНроХрпКро▓рпИ", "роЪро╛роХ ро╡рпЗрогрпНроЯрпБроорпН", "роЙропро┐ро░рпН рокрпЛроХ ро╡рпЗрогрпНроЯрпБроорпН", "роЗро▒роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН",
  "родройрпНройрпИ роХрпКро▓рпНро▓", "роЙропро┐ро░рпИ рооро╛ропрпНродрпНродрпБ", "ро╡ро╛ро┤рпНроХрпНроХрпИ ро╡рпЗрогрпНроЯро╛роорпН"
];

// Intent classification keywords
const INTENT_KEYWORDS = {
  anxiety: ["anxious", "nervous", "worry", "panic", "scared", "fear", "tension", "роХро╡ро▓рпИ", "рокропроорпН", "рокродроЯрпНроЯроорпН"],
  stress: ["stress", "pressure", "overwhelmed", "burden", "tired", "exhausted", "роорой роЕро┤рпБродрпНродроорпН", "роЪрпЛро░рпНро╡рпБ", "роирпЖро░ро┐роЪро▓рпН"],
  sleep: ["sleep", "insomnia", "tired", "sleepy", "rest", "bed", "dream", "nightmare", "родрпВроХрпНроХроорпН", "роЙро▒роХрпНроХроорпН", "роХройро╡рпБ"],
  low_mood: ["sad", "depressed", "down", "lonely", "empty", "hopeless", "worthless", "роЪрпЛроХроорпН", "рооройро╡рпЗродройрпИ", "родройро┐роорпИ"],
  coping: ["help", "cope", "manage", "deal with", "handle", "strategy", "technique", "роЙродро╡ро┐", "роЪрооро╛ро│ро┐роХрпНроХ", "роорпБро▒рпИ"],
  mood_tracking: ["mood", "feeling", "track", "record", "log", "diary", "рооройроиро┐ро▓рпИ", "роЙрогро░рпНро╡рпБ", "рокродро┐ро╡рпБ"],
  gratitude: ["thank", "grateful", "appreciate", "positive", "good", "happy", "blessed", "роиройрпНро▒ро┐", "роороХро┐ро┤рпНроЪрпНроЪро┐", "роиро▓рпНро▓родрпБ"],
  meta: ["who are you", "what are you", "doctor", "therapist", "medical", "ропро╛ро░рпН роирпАроЩрпНроХро│рпН", "роОройрпНрой роирпАроЩрпНроХро│рпН", "рооро░рпБродрпНродрпБро╡ро░рпН"]
};

// Response templates
const RESPONSES = {
  english: {
    crisis: "I'm very concerned about what you've shared. If you're having thoughts of self-harm, please reach out for immediate help:\n\nЁЯЪи Emergency: 112\nЁЯУЮ Mental Health Helpline: 1800-599-0019\nЁЯТм Text HELLO to 741741\n\nYou matter, and there are people who want to help you through this difficult time.",
    
    anxiety: "I understand you're feeling anxious. Anxiety can be overwhelming, but there are ways to help manage it:\n\nтАв Try the 4-7-8 breathing technique: Breathe in for 4, hold for 7, exhale for 8\nтАв Ground yourself: Name 5 things you can see, 4 you can hear, 3 you can touch\nтАв Remember: This feeling will pass\n\nWould you like to practice a breathing exercise together?",
    
    stress: "Stress can feel overwhelming, but you're not alone in this. Here are some gentle techniques:\n\nтАв Take a few slow, deep breaths\nтАв Try the 5-minute rule: Focus on just the next 5 minutes\nтАв Practice self-compassion - be kind to yourself\nтАв Consider what you can control vs. what you can't\n\nWhat's one small thing that usually helps you feel calmer?",
    
    sleep: "Sleep troubles can really affect how we feel. Here are some gentle sleep hygiene tips:\n\nтАв Try to keep consistent sleep/wake times\nтАв Create a calming bedtime routine\nтАв Limit screens 1 hour before bed\nтАв Try progressive muscle relaxation\n\nHave you noticed any patterns in what affects your sleep?",
    
    low_mood: "I hear that you're going through a difficult time. Your feelings are valid, and it's okay to not be okay sometimes.\n\nтАв Remember: You are worthy of care and support\nтАв Try to do one small thing you usually enjoy\nтАв Connect with someone you trust\nтАв Be gentle with yourself\n\nWould you like to talk about what's been weighing on your mind?",
    
    coping: "It's wonderful that you're looking for healthy ways to cope. Here are some evidence-based techniques:\n\nтАв Mindfulness: Try 5-10 minutes of meditation daily\nтАв Physical activity: Even a short walk can help\nтАв Creative outlets: Drawing, writing, music\nтАв Social connection: Reach out to supportive people\n\nWhat type of activities usually feel most natural to you?",
    
    mood_tracking: "Tracking your mood is a great way to understand your patterns! I can help you log how you're feeling. Would you like to record your current mood? You can rate it from 0-10 and add any notes about what might be influencing how you feel today.",
    
    gratitude: "Thank you for sharing that positive moment! Gratitude can be really powerful for our wellbeing. Some ways to build on this:\n\nтАв Keep a daily gratitude journal\nтАв Share appreciation with others\nтАв Notice small positive moments\nтАв Celebrate your progress\n\nWhat's something else you've been grateful for recently?",
    
    meta: "I'm a supportive chatbot designed to provide wellness guidance and a listening ear. I'm not a doctor or therapist, and I can't provide medical advice or diagnosis. I'm here to offer evidence-based coping strategies and emotional support. For professional help, please consult qualified mental health professionals.",
    
    general: "I'm here to listen and support you. Sometimes just talking about what's on your mind can help. Feel free to share whatever you're comfortable with - whether it's how you're feeling, something that's bothering you, or even something positive that happened today."
  },
  
  tamil: {
    crisis: "роирпАроЩрпНроХро│рпН рокроХро┐ро░рпНроирпНрод ро╡ро┐ро╖ропродрпНродрпИрокрпН рокро▒рпНро▒ро┐ роиро╛ройрпН рооро┐роХро╡рпБроорпН роХро╡ро▓рпИрокрпНрокроЯрпБроХро┐ро▒рпЗройрпН. роЙроЩрпНроХро│рпБроХрпНроХрпБ родройрпНройрпИ роХро╛ропрокрпНрокроЯрпБродрпНродрпБроорпН роОрогрпНрогроЩрпНроХро│рпН роЗро░рпБроирпНродро╛ро▓рпН, роЙроЯройроЯро┐ропро╛роХ роЙродро╡ро┐ роХрпЗро│рпБроЩрпНроХро│рпН:\n\nЁЯЪи роЕро╡роЪро░роиро┐ро▓рпИ: 112\nЁЯУЮ рооройроиро▓роорпН роЙродро╡ро┐ роОрогрпН: 1800-599-0019\n\nроирпАроЩрпНроХро│рпН роорпБроХрпНроХро┐ропрооро╛ройро╡ро░рпН, роЗроирпНрод роХроЯро┐ройрооро╛рой роирпЗро░родрпНродро┐ро▓рпН роЙроЩрпНроХро│рпБроХрпНроХрпБ роЙродро╡ ро╡ро┐ро░рпБроорпНрокрпБроорпН роороХрпНроХро│рпН роЙро│рпНро│ройро░рпН.",
    
    anxiety: "роирпАроЩрпНроХро│рпН роХро╡ро▓рпИропро╛роХ роЙрогро░рпНроХро┐ро▒рпАро░рпНроХро│рпН роОройрпНрокродрпИ роиро╛ройрпН рокрпБро░ро┐роирпНродрпБроХрпКро│рпНроХро┐ро▒рпЗройрпН. роХро╡ро▓рпИ рооро┐роХро╡рпБроорпН роХроЯро┐ройрооро╛роХ роЗро░рпБроХрпНроХрпБроорпН, роЖройро╛ро▓рпН роЕродрпИ роЪрооро╛ро│ро┐роХрпНроХ ро╡ро┤ро┐роХро│рпН роЙро│рпНро│рой:\n\nтАв 4-7-8 роорпВроЪрпНроЪрпБ роирпБроЯрпНрокроорпН: 4 роОрогрпНрогрпБроЩрпНроХро│рпН, 7 роиро┐ро▒рпБродрпНродрпБроЩрпНроХро│рпН, 8 роорпВроЪрпНроЪрпИ ро╡рпЖро│ро┐ропрпЗ ро╡ро┐роЯрпБроЩрпНроХро│рпН\nтАв родро░рпИропро┐ро▓рпН роХро╛ро▓рпНрокродро┐роХрпНроХро╡рпБроорпН: 5 ро╡ро┐ро╖ропроЩрпНроХро│рпИрокрпН рокро╛ро░рпБроЩрпНроХро│рпН, 4 роХрпЗро│рпБроЩрпНроХро│рпН, 3 родрпКроЯрпБроЩрпНроХро│рпН\nтАв роиро┐ройрпИро╡ро┐ро▓рпН ро╡рпИроХрпНроХро╡рпБроорпН: роЗроирпНрод роЙрогро░рпНро╡рпБ роХроЯроирпНродрпБ рокрпЛроХрпБроорпН\n\nроЪрпЗро░рпНроирпНродрпБ роорпВроЪрпНроЪрпБрокрпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНроп ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?",
    
    stress: "роорой роЕро┤рпБродрпНродроорпН рооро┐роХро╡рпБроорпН роХроЯро┐ройрооро╛роХ роЙрогро░ро▓ро╛роорпН, роЖройро╛ро▓рпН роЗродро┐ро▓рпН роирпАроЩрпНроХро│рпН родройро┐ропро╛роХ роЗро▓рпНро▓рпИ. роЪро┐ро▓ роорпЖройрпНроорпИропро╛рой роирпБроЯрпНрокроЩрпНроХро│рпН:\n\nтАв роЪро┐ро▓ роорпЖродрпБро╡ро╛рой, роЖро┤рооро╛рой роорпВроЪрпНроЪрпБроХро│рпН роОроЯрпБроЩрпНроХро│рпН\nтАв 5 роиро┐рооро┐роЯ ро╡ро┐родро┐: роЕроЯрпБродрпНрод 5 роиро┐рооро┐роЯроЩрпНроХро│ро┐ро▓рпН роороЯрпНроЯрпБроорпН роХро╡ройроорпН роЪрпЖро▓рпБродрпНродрпБроЩрпНроХро│рпН\nтАв роЙроЩрпНроХро│рпБроХрпНроХрпБ роЗро░роХрпНроХроорпН роХро╛роЯрпНроЯрпБроЩрпНроХро│рпН\nтАв роирпАроЩрпНроХро│рпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНрод роорпБроЯро┐ропро╛родро╡ро▒рпНро▒рпИ ро╡ро┐роЯрпНроЯрпБро╡ро┐роЯрпБроЩрпНроХро│рпН\n\nроЪро╛родро╛ро░рогрооро╛роХ роЙроЩрпНроХро│рпИ роЕроорпИродро┐рокрпНрокроЯрпБродрпНрод роЙродро╡рпБроорпН роТро░рпБ роЪро┐ро▒ро┐роп ро╡ро┐ро╖ропроорпН роОройрпНрой?",
    
    sleep: "родрпВроХрпНроХрокрпН рокро┐ро░роЪрпНроЪройрпИроХро│рпН роироорпН роЙрогро░рпНро╡рпБроХро│рпИ рооро┐роХро╡рпБроорпН рокро╛родро┐роХрпНроХрпБроорпН. роЪро┐ро▓ роорпЖройрпНроорпИропро╛рой родрпВроХрпНроХ роЪрпБроХро╛родро╛ро░ роХрпБро▒ро┐рокрпНрокрпБроХро│рпН:\n\nтАв роиро┐ро▓рпИропро╛рой родрпВроХрпНроХ/ро╡ро┐ро┤ро┐рокрпНрокрпБ роирпЗро░роорпН ро╡рпИроХрпНроХро╡рпБроорпН\nтАв роЕроорпИродро┐ропро╛рой рокроЯрпБроХрпНроХрпИ роирпЗро░ ро╡ро┤роХрпНроХроорпН роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН\nтАв рокроЯрпБроХрпНроХрпИроХрпНроХрпБ 1 роорогро┐ роирпЗро░родрпНродро┐ро▒рпНроХрпБ роорпБройрпН родро┐ро░рпИроХро│рпИроХрпН роХрпБро▒рпИроХрпНроХро╡рпБроорпН\nтАв рокроЯро┐рокрпНрокроЯро┐ропро╛рой родроЪрпИ родро│ро░рпНро╡рпИрокрпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрпБроЩрпНроХро│рпН\n\nроЙроЩрпНроХро│рпН родрпВроХрпНроХродрпНродрпИрокрпН рокро╛родро┐роХрпНроХрпБроорпН роОродрпИропро╛ро╡родрпБ роХро╡ройро┐родрпНродро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
    
    low_mood: "роирпАроЩрпНроХро│рпН роХроЯро┐ройрооро╛рой роХро╛ро▓родрпНродро┐ро▓рпН роЗро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│рпН роОройрпНрокродрпИ роиро╛ройрпН роХрпЗроЯрпНроХро┐ро▒рпЗройрпН. роЙроЩрпНроХро│рпН роЙрогро░рпНро╡рпБроХро│рпН роЪро░ро┐ропро╛ройро╡рпИ, роЪро┐ро▓ роирпЗро░роЩрпНроХро│ро┐ро▓рпН роиро▓рпНро▓ро╛роХ роЗро▓рпНро▓ро╛рооро▓рпН роЗро░рпБрокрпНрокродрпБ рокро░ро╡ро╛ропро┐ро▓рпНро▓рпИ.\n\nтАв роиро┐ройрпИро╡ро┐ро▓рпН роХрпКро│рпНро│рпБроЩрпНроХро│рпН: роирпАроЩрпНроХро│рпН рокро░ро╛рооро░ро┐рокрпНрокрпБроХрпНроХрпБ родроХрпБродро┐ропро╛ройро╡ро░рпН\nтАв роирпАроЩрпНроХро│рпН рокрпКродрпБро╡ро╛роХ роЕройрпБрокро╡ро┐роХрпНроХрпБроорпН роТро░рпБ роЪро┐ро▒ро┐роп ро╡ро┐ро╖ропродрпНродрпИроЪрпН роЪрпЖропрпНроп роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН\nтАв роирпАроЩрпНроХро│рпН роироорпНрокрпБроорпН роТро░рпБро╡ро░рпБроЯройрпН родрпКроЯро░рпНрокрпБ роХрпКро│рпНро│рпБроЩрпНроХро│рпН\nтАв роЙроЩрпНроХро│рпБроХрпНроХрпБ роорпЖройрпНроорпИропро╛роХ роЗро░рпБроЩрпНроХро│рпН\n\nроЙроЩрпНроХро│рпН рооройродрпИ рокро╛ро░рооро╛роХрпНроХрпБроорпН ро╡ро┐ро╖ропродрпНродрпИрокрпН рокро▒рпНро▒ро┐ рокрпЗроЪ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?",
    
    coping: "роЖро░рпЛроХрпНроХро┐ропрооро╛рой ро╡ро┤ро┐роХро│рпИродрпН родрпЗроЯрпБро╡родрпБ роЕро░рпБроорпИ. роЪро┐ро▓ роЪро╛ройрпНро▒рпБ роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓ро╛рой роирпБроЯрпНрокроЩрпНроХро│рпН:\n\nтАв роиро┐ройрпИро╡ро╛ро▒рпНро▒ро▓рпН: родро┐ройроорпБроорпН 5-10 роиро┐рооро┐роЯроЩрпНроХро│рпН родро┐ропро╛ройроорпН роЪрпЖропрпНропрпБроЩрпНроХро│рпН\nтАв роЙроЯро▓рпН роЪрпЖропро▓рпНрокро╛роЯрпБ: роТро░рпБ роЪро┐ро▒ро┐роп роироЯрпИроХрпВроЯ роЙродро╡рпБроорпН\nтАв рокроЯрпИрокрпНрокрпБ: ро╡ро░рпИродро▓рпН, роОро┤рпБродрпБродро▓рпН, роЗроЪрпИ\nтАв роЪроорпВроХ родрпКроЯро░рпНрокрпБ: роЖродро░ро╡ро╛рой роороХрпНроХро│рпИ родрпКроЯро░рпНрокрпБ роХрпКро│рпНро│рпБроЩрпНроХро│рпН\n\nрокрпКродрпБро╡ро╛роХ роОроирпНрод ро╡роХрпИропро╛рой роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпН роЙроЩрпНроХро│рпБроХрпНроХрпБ роЗропро▓рпНрокро╛роХ роЙрогро░рпНроХро┐ройрпНро▒рой?",
    
    mood_tracking: "роЙроЩрпНроХро│рпН рооройроиро┐ро▓рпИропрпИроХрпН роХрогрпНроХро╛рогро┐рокрпНрокродрпБ роЙроЩрпНроХро│рпН роорпБро▒рпИроХро│рпИрокрпН рокрпБро░ро┐роирпНродрпБроХрпКро│рпНро│ роТро░рпБ роЪро┐ро▒роирпНрод ро╡ро┤ро┐! роирпАроЩрпНроХро│рпН роОрокрпНрокроЯро┐ роЙрогро░рпНроХро┐ро▒рпАро░рпНроХро│рпН роОройрпНрокродрпИрокрпН рокродро┐ро╡рпБ роЪрпЖропрпНроп роиро╛ройрпН роЙродро╡ роорпБроЯро┐ропрпБроорпН. роЙроЩрпНроХро│рпН родро▒рпНрокрпЛродрпИроп рооройроиро┐ро▓рпИропрпИрокрпН рокродро┐ро╡рпБ роЪрпЖропрпНроп ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛? роирпАроЩрпНроХро│рпН роЕродрпИ 0-10 роОрой роородро┐рокрпНрокро┐роЯрпНроЯрпБ, роЗройрпНро▒рпБ роЙроЩрпНроХро│рпИ роОрокрпНрокроЯро┐ роЙрогро░ ро╡рпИроХрпНроХро┐ро▒родрпБ роОройрпНрокродрпИрокрпН рокро▒рпНро▒ро┐роп роХрпБро▒ро┐рокрпНрокрпБроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро▓ро╛роорпН.",
    
    gratitude: "роЕроирпНрод роирпЗро░рпНрооро▒рпИропро╛рой родро░рпБрогродрпНродрпИрокрпН рокроХро┐ро░рпНроирпНродродро▒рпНроХрпБ роиройрпНро▒ро┐! роиройрпНро▒ро┐ропрпБрогро░рпНро╡рпБ роироорпН роиро▓рпНро╡ро╛ро┤рпНро╡рпБроХрпНроХрпБ рооро┐роХро╡рпБроорпН роЪроХрпНродро┐ро╡ро╛ропрпНntрпНродродрпБ. роЗродрпИ ро╡ро│ро░рпНроХрпНроХрпБроорпН роЪро┐ро▓ ро╡ро┤ро┐роХро│рпН:\n\nтАв родро┐ройроЪро░ро┐ роиройрпНро▒ро┐ рокродрпНродро┐ро░ро┐роХрпИ ро╡рпИроХрпНроХро╡рпБроорпН\nтАв рооро▒рпНро▒ро╡ро░рпНроХро│рпБроЯройрпН рокро╛ро░ро╛роЯрпНроЯрпБроХро│рпИрокрпН рокроХро┐ро░рпНроирпНродрпБ роХрпКро│рпНро│рпБроЩрпНроХро│рпН\nтАв роЪро┐ро▒ро┐роп роирпЗро░рпНрооро▒рпИропро╛рой родро░рпБрогроЩрпНроХро│рпИроХрпН роХро╡ройро┐ропрпБроЩрпНроХро│рпН\nтАв роЙроЩрпНроХро│рпН роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИроХрпН роХрпКрогрпНроЯро╛роЯрпБроЩрпНроХро│рпН\n\nроирпАроЩрпНроХро│рпН роЪроорпАрокродрпНродро┐ро▓рпН роиройрпНро▒ро┐ропрпБрогро░рпНроирпНрод ро╡рпЗро▒рпБ роПродро╛ро╡родрпБ роЗро░рпБроХрпНроХро┐ро▒родро╛?",
    
    meta: "роиро╛ройрпН роиро▓рпНро╡ро╛ро┤рпНро╡рпБ ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпИропрпБроорпН роХрпЗроЯрпНроХрпБроорпН роХро╛родрпИропрпБроорпН ро╡ро┤роЩрпНроХ ро╡роЯро┐ро╡роорпИроХрпНроХрокрпНрокроЯрпНроЯ роТро░рпБ роЖродро░ро╡рпБ роЪро╛роЯрпНрокро╛роЯрпН. роиро╛ройрпН рооро░рпБродрпНродрпБро╡ро░рпН роЕро▓рпНро▓родрпБ роЪро┐роХро┐роЪрпНроЪрпИропро╛ро│ро░рпН роЕро▓рпНро▓, рооро░рпБродрпНродрпБро╡ роЖро▓рпЛроЪройрпИ роЕро▓рпНро▓родрпБ роирпЛропро▒ро┐родро▓рпИ ро╡ро┤роЩрпНроХ роорпБроЯро┐ропро╛родрпБ. роЪро╛ройрпНро▒рпБ роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓ро╛рой роЪрооро╛ро│ро┐рокрпНрокрпБ роЙродрпНродро┐роХро│рпН рооро▒рпНро▒рпБроорпН роЙрогро░рпНроЪрпНроЪро┐ роЖродро░ро╡рпИ ро╡ро┤роЩрпНроХ роиро╛ройрпН роЗроЩрпНроХрпЗ роЗро░рпБроХрпНроХро┐ро▒рпЗройрпН. родрпКро┤ро┐ро▓рпНроорпБро▒рпИ роЙродро╡ро┐роХрпНроХрпБ, родроХрпБродро┐ропро╛рой рооройроиро▓ роиро┐рокрпБрогро░рпНроХро│рпИроХрпН роХро▓роирпНродро╛ро▓рпЛроЪро┐роХрпНроХро╡рпБроорпН.",
    
    general: "роиро╛ройрпН роЙроЩрпНроХро│рпИроХрпН роХрпЗроЯрпНроЯрпБ роЖродро░ро┐роХрпНроХ роЗроЩрпНроХрпЗ роЗро░рпБроХрпНроХро┐ро▒рпЗройрпН. роЪро┐ро▓ роирпЗро░роЩрпНроХро│ро┐ро▓рпН роЙроЩрпНроХро│рпН рооройродро┐ро▓рпН роЙро│рпНро│родрпИрокрпН рокро▒рпНро▒ро┐ рокрпЗроЪрпБро╡родрпЗ роЙродро╡ро┐ропро╛роХ роЗро░рпБроХрпНроХрпБроорпН. роирпАроЩрпНроХро│рпН ро╡роЪродро┐ропро╛роХ роЙрогро░рпБроорпН роОродрпИропрпБроорпН рокроХро┐ро░ро▓ро╛роорпН - роирпАроЩрпНроХро│рпН роОрокрпНрокроЯро┐ роЙрогро░рпНроХро┐ро▒рпАро░рпНроХро│рпН, роЙроЩрпНроХро│рпИродрпН родрпКроирпНродро░ро╡рпБ роЪрпЖропрпНропрпБроорпН роПродро╛ро╡родрпБ, роЕро▓рпНро▓родрпБ роЗройрпНро▒рпБ роироЯроирпНрод роирпЗро░рпНрооро▒рпИропро╛рой роПродро╛ро╡родрпБ."
  }
};

// Detect crisis keywords in user input
function detectCrisis(input: string): boolean {
  const lowerInput = input.toLowerCase();
  return CRISIS_KEYWORDS.some(keyword => lowerInput.includes(keyword));
}

// Classify user intent based on keywords
function classifyIntent(input: string): Intent {
  const lowerInput = input.toLowerCase();
  
  // Check for each intent
  for (const [intent, keywords] of Object.entries(INTENT_KEYWORDS)) {
    if (keywords.some(keyword => lowerInput.includes(keyword))) {
      return intent as Intent;
    }
  }
  
  // Common greeting patterns
  if (/^(hi|hello|hey|good morning|good evening|ро╡рогроХрпНроХроорпН|ро╣ро▓рпЛ)/i.test(lowerInput)) {
    return "greeting";
  }
  
  return "general";
}

// Main chat AI function
export async function chatAI(userInput: string, language: Language): Promise<ChatResponse> {
  // Simulate processing delay
  await new Promise(resolve => setTimeout(resolve, 500));
  
  const isEmergency = detectCrisis(userInput);
  
  if (isEmergency) {
    return {
      message: RESPONSES[language].crisis,
      intent: "crisis",
      isEmergency: true
    };
  }
  
  const intent = classifyIntent(userInput);
  const responseKey = intent as keyof typeof RESPONSES.english;
  const message = RESPONSES[language][responseKey] || RESPONSES[language].general;
  
  return {
    message,
    intent,
    isEmergency: false
  };
}